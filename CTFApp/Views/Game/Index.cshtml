@model GameViewModel

@{
    ViewBag.Title = "CTF Game";

    //Adding CSP
    Context.Response.Headers["Content-Security-Policy"] = "script-src 'self';";
}

<div class="container">
    @if (Model.CurrentUser != null)
    {
        <div class="current-user-stats mb-4">
            <h3>Welcome, @Model.CurrentUser.Username!</h3>
            <p>Your Current Score: @Model.CurrentUser.userScore</p>
        </div>
    }

    <div id="game-container" class="mb-4">
        <h2>Simple CTF Game</h2>
 
        <input type="hidden" id="userName" value="@Model.CurrentUser?.Username" />
        <p>Click the button as fast as you can!</p>
        <button id="startGame" class="btn btn-primary">Start Game</button>
        <button id="clickButton" class="btn btn-success" style="display: none;">Click Me!</button>
        <p id="scoreDisplay"></p>
    </div>

    <div class="leaderboard">
        <h3>Leaderboard</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Username</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody>
                @{
                    int rank = 1;
                }
                @foreach (var user in Model.Users)
                {
                    <tr class="@(user.Username == Model.CurrentUser?.Username ? "table-primary" : "")">
                        <td>@(rank++)</td>
                        <td>@user.Username</td>
                        <td>@user.userScore</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>


    <div id="chat-container" class="mb-4">
        <h3>Chat</h3>
        <div id="chat-messages"></div>
        <input type="text" id="messageInput" placeholder="Type a message..." />
        <button id="sendButton">Send</button>
    </div>
</div>

@section Scripts {
   

    <script src="~/lib/microsoft/signalr/dist/browser/signalr.min.js"></script>
    <script src="~/js/game.js"></script>
    <script src="~/js/chat.js"></script>
 

    
  
}